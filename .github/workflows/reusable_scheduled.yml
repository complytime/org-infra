name: Reusable Scheduled Jobs

# --------------------------------------------------------------------------
# This workflow is only run when explicitly called by another workflow.
# --------------------------------------------------------------------------
on:
  workflow_call:
    inputs:
      scan-args:
        description: 'Additional arguments to pass to osv-scanner'
        required: false
        type: string

# This workflow is passive so ensure the minimal permissions even if the
# inherited token is more lenient.
permissions:
  contents: read
  issues: none
  pull-requests: none
  actions: none
  security-events: none

jobs:
  scan:
    name: OVS-Scanner
    # https://google.github.io/osv-scanner/github-action/
    uses: google/osv-scanner-action/.github/workflows/osv-scanner-reusable.yml@9bb69575e74019c2ad085a1860787043adf47ccb # v2.2.4
    permissions:
      actions: read           # Required to upload SARIF file to CodeQL. See: https://github.com/github/codeql-action/issues/2117
      security-events: write  # Require writing security events to upload SARIF file to security tab
    with:
      scan-args: "${{ inputs.scan-args }}"
      fail-on-vuln: true
      upload-sarif: true
